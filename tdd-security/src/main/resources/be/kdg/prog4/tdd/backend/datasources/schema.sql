-- ALTER TABLE Bid DROP CONSTRAINT FKBid353389;
-- ALTER TABLE Person DROP CONSTRAINT FKPerson166894;
-- ALTER TABLE Bid DROP CONSTRAINT FKBid926049;
-- ALTER TABLE Bid DROP CONSTRAINT FKBid121390;
-- ALTER TABLE Repair DROP CONSTRAINT FKRepair835623;
-- ALTER TABLE Repair DROP CONSTRAINT FKRepair505504;
-- ALTER TABLE Repair DROP CONSTRAINT FKRepair403691;
-- ALTER TABLE Repair DROP CONSTRAINT FKRepair2771;
-- ALTER TABLE Bid DROP CONSTRAINT FKBid176439;
-- ALTER TABLE "User" DROP CONSTRAINT FKUser589049;
-- ALTER TABLE Repair DROP CONSTRAINT FKRepair383357;
DROP TABLE "User" IF EXISTS;
DROP TABLE Address IF EXISTS;
DROP TABLE Person IF EXISTS;
DROP TABLE Bid IF EXISTS;
DROP TABLE RepairDetails IF EXISTS;
DROP TABLE Item IF EXISTS;
DROP TABLE Repair IF EXISTS;
CREATE TABLE "User" (
  UserId        INT GENERATED BY DEFAULT AS IDENTITY,
  PersonId      INT          NOT NULL,
  Username      VARCHAR(255),
  Password      VARCHAR(255),
  OveralRating  DOUBLE,
  Rated         BIT,
  Degree        VARCHAR(255),
  Discriminator VARCHAR(255) NOT NULL,
  PRIMARY KEY (UserId)
);

CREATE TABLE Address (
  AddressId INT GENERATED BY DEFAULT AS IDENTITY,
  Street    VARCHAR(255),
  Nr        VARCHAR(255),
  Zip       VARCHAR(255),
  City      VARCHAR(255),
  PRIMARY KEY (AddressId)
);
CREATE TABLE Person (
  PersonId  INT GENERATED BY DEFAULT AS IDENTITY,
  AddressId INT NOT NULL,
  Firstname VARCHAR(255),
  Lastname  VARCHAR(255),
  PRIMARY KEY (PersonId)
);
CREATE TABLE Bid (
  BidId         INT GENERATED BY DEFAULT AS IDENTITY,
  RepairId      INT,
  UserId        INT,
  MyRepairId    INT,
  MyRepairerId  INT,
  Timestamp     TIMESTAMP,
  Price         DOUBLE       NOT NULL,
  Comment       VARCHAR(255),
  Accepted      BIT          NOT NULL,
  Eligible      BIT          NOT NULL,
  Discriminator VARCHAR(255) NOT NULL,
  PRIMARY KEY (BidId)
);
CREATE TABLE RepairDetails (
  RepairDetailsId INT GENERATED BY DEFAULT AS IDENTITY,
  Defect          VARCHAR(255),
  Description     VARCHAR(255),
  Evaluation      VARCHAR(255),
  Rebuttal        VARCHAR(255),
  Rating          VARCHAR(255) NOT NULL,
  Status          VARCHAR(255) NOT NULL,
  PriceModel      VARCHAR(255) NOT NULL,
  DueDate         TIMESTAMP,
  SubmitDate      TIMESTAMP,
  Assigned        BIT          NOT NULL,
  PRIMARY KEY (RepairDetailsId)
);
CREATE TABLE Item (
  ItemId      INT GENERATED BY DEFAULT AS IDENTITY,
  ProductName VARCHAR(255),
  Brand       VARCHAR(255),
  Category    VARCHAR(255),
  PRIMARY KEY (ItemId)
);
CREATE TABLE Repair (
  RepairId        INT GENERATED BY DEFAULT AS IDENTITY,
  UserId          INT,
  ItemId          INT NOT NULL,
  RepairDetailsId INT NOT NULL,
  RepairerId      INT,
  ClientId        INT,
  PRIMARY KEY (RepairId)
);
ALTER TABLE Bid ADD CONSTRAINT FKBid353389 FOREIGN KEY (UserId) REFERENCES "User" (UserId);
ALTER TABLE Person ADD CONSTRAINT FKPerson166894 FOREIGN KEY (AddressId) REFERENCES Address (AddressId);
ALTER TABLE Bid ADD CONSTRAINT FKBid926049 FOREIGN KEY (MyRepairerId) REFERENCES "User" (UserId);
ALTER TABLE Bid ADD CONSTRAINT FKBid121390 FOREIGN KEY (MyRepairId) REFERENCES Repair (RepairId);
ALTER TABLE Repair ADD CONSTRAINT FKRepair835623 FOREIGN KEY (ClientId) REFERENCES "User" (UserId);
ALTER TABLE Repair ADD CONSTRAINT FKRepair505504 FOREIGN KEY (RepairerId) REFERENCES "User" (UserId);
ALTER TABLE Repair ADD CONSTRAINT FKRepair403691 FOREIGN KEY (RepairDetailsId) REFERENCES RepairDetails (RepairDetailsId);
ALTER TABLE Repair ADD CONSTRAINT FKRepair2771 FOREIGN KEY (ItemId) REFERENCES Item (ItemId);
ALTER TABLE Bid ADD CONSTRAINT FKBid176439 FOREIGN KEY (RepairId) REFERENCES Repair (RepairId);
ALTER TABLE "User" ADD CONSTRAINT FKUser589049 FOREIGN KEY (PersonId) REFERENCES Person (PersonId);
ALTER TABLE Repair ADD CONSTRAINT FKRepair383357 FOREIGN KEY (UserId) REFERENCES "User" (UserId);
